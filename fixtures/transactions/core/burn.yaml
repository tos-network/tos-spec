# TOS Burn Transaction Conformance Specifications
# Based on: common/src/transaction/payload/burn.rs
#
# Permanently destroy TOS or tokens (proof of burn)

---
spec:
  name: tx_burn_basic
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Basic TOS burn transaction"
  priority: P0

preconditions:
  - sender:
      address: "tos1sender..."
      balance: 1000000000  # 10 TOS
      nonce: 0

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0x0000...0000"  # TOS_ASSET
    amount: 100000000  # 1 TOS
    fee: 10000
    nonce: 0

expected:
  status: success

postconditions:
  - sender:
      balance: 899990000  # 10 - 1 - fee
      nonce: 1
  - total_supply:
      decrease: 100000000  # 1 TOS burned

---
spec:
  name: tx_burn_token
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Burn custom token"
  priority: P1

preconditions:
  - sender:
      balances:
        "0x0000...0000": 100000000  # 1 TOS for fee
        "0xtoken...": 500000000  # 5 tokens

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0xtoken..."  # Custom token
    amount: 200000000  # 2 tokens
    fee: 10000

expected:
  status: success

postconditions:
  - sender:
      balances:
        "0x0000...0000": 99990000  # Fee deducted
        "0xtoken...": 300000000  # 3 tokens remaining
  - token:
      asset: "0xtoken..."
      supply_decrease: 200000000

---
spec:
  name: tx_burn_zero_amount
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Zero amount burn rejected"
  priority: P0

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0x0000...0000"
    amount: 0

expected:
  status: error
  error: "InvalidAmount"

---
spec:
  name: tx_burn_insufficient_balance
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Cannot burn more than balance"
  priority: P0

preconditions:
  - sender:
      balance: 100000000  # 1 TOS

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0x0000...0000"
    amount: 500000000  # 5 TOS (more than balance)

expected:
  status: error
  error: "InsufficientBalance"

---
spec:
  name: tx_burn_full_balance
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Burn entire balance"
  priority: P1

preconditions:
  - sender:
      balance: 1000000000  # 10 TOS

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0x0000...0000"
    amount: 999990000  # All except fee
    fee: 10000

expected:
  status: success

postconditions:
  - sender:
      balance: 0

---
spec:
  name: tx_burn_unknown_asset
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Burn unknown asset fails"
  priority: P0

action:
  type: transaction
  tx_type: Burn
  params:
    asset: "0xunknown..."  # Non-existent asset
    amount: 100000000

expected:
  status: error
  error: "AssetNotFound"

---
spec:
  name: tx_burn_payload_structure
  version: "1.0"
  category: transactions
  subcategory: core
  description: "BurnPayload wire format"
  priority: P0

definition:
  burn_payload:
    asset:
      type: Hash
      size: 32
      description: "Asset identifier to burn"
    amount:
      type: u64
      size: 8
      description: "Amount to burn in atomic units"

serialization_order:
  - asset (32 bytes)
  - amount (8 bytes)

total_size: 40 bytes

---
spec:
  name: tx_burn_use_cases
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Common burn use cases"
  priority: P2

use_cases:
  - name: contract_deployment_burn
    description: "1 TOS burned on contract deployment"
    amount: 100000000

  - name: token_deflationary_burn
    description: "Token burn for deflationary mechanism"
    note: "DeFi protocols may burn tokens on trades"

  - name: proof_of_burn
    description: "Burn as proof of commitment"
    note: "Transaction hash serves as burn receipt"

---
spec:
  name: tx_burn_gas_cost
  version: "1.0"
  category: transactions
  subcategory: core
  description: "Burn transaction gas consumption"
  priority: P1

definition:
  gas_cost: 5000  # Base cost for burn operation

note: |
  Burn is a simple operation:
  1. Verify sender has sufficient balance
  2. Deduct amount from sender
  3. Decrease total supply
